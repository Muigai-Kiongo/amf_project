{% extends "base.html" %}
{% load humanize %}
{% block title %}Transactions{% endblock %}
{% block content %}
<h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
    <i class="fa-solid fa-arrows-rotate text-blue-500"></i> Transactions
</h2>
<a href="{% url 'transaction-create' %}" class="inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-500 transition mb-6 shadow">
    <i class="fa-solid fa-plus mr-2"></i> Add Transaction
</a>
<div class="overflow-x-auto">
    <table class="min-w-full bg-white rounded-lg shadow">
        <thead class="bg-gray-100">
            <tr>
                <th class="py-3 px-4 text-left font-semibold text-gray-700">Date</th>
                <th class="py-3 px-4 text-left font-semibold text-gray-700">Type</th>
                <th class="py-3 px-4 text-left font-semibold text-gray-700">Account</th>
                <th class="py-3 px-4 text-left font-semibold text-gray-700">Goal</th>
                <th class="py-3 px-4 text-left font-semibold text-gray-700">Amount (KES)</th>
                <th class="py-3 px-4 text-left font-semibold text-gray-700">Description</th>
                <th class="py-3 px-4 text-left font-semibold text-gray-700">Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for transaction in transactions %}
        <tr class="border-t">
            <td class="py-2 px-4">
                <span class="bg-gray-200 text-gray-800 px-3 py-1 rounded text-sm">{{ transaction.date|date:"Y-m-d" }}</span>
            </td>
            <td class="py-2 px-4">
                <span class="px-2 py-1 rounded text-xs
                    {% if transaction.type == 'income' %}
                        bg-green-100 text-green-700
                    {% elif transaction.type == 'expense' %}
                        bg-red-100 text-red-700
                    {% else %}
                        bg-gray-100 text-gray-700
                    {% endif %}">
                    {{ transaction.get_type_display }}
                </span>
            </td>
            <td class="py-2 px-4">
                <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded text-sm">{{ transaction.account.name }}</span>
            </td>
            <td class="py-2 px-4">
                {% if transaction.goal %}
                    <span class="bg-teal-100 text-teal-700 px-3 py-1 rounded text-sm">{{ transaction.goal.name }}</span>
                {% else %}
                    <span class="text-gray-400 italic">-</span>
                {% endif %}
            </td>
            <td class="py-2 px-4">
                <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded text-sm font-mono">{{ transaction.amount|floatformat:2|intcomma }}</span>
            </td>
            <td class="py-2 px-4">
                {{ transaction.description|default:"(No description)" }}
            </td>
            <td class="py-2 px-4">
                <a href="{% url 'transaction-detail' transaction.pk %}" class="inline-flex items-center bg-blue-100 text-blue-700 px-3 py-1 rounded hover:bg-blue-200 transition mr-2 text-sm">
                    <i class="fa-solid fa-eye mr-1"></i> View
                </a>
                <a href="{% url 'transaction-update' transaction.pk %}" class="inline-flex items-center bg-yellow-400 text-gray-900 px-3 py-1 rounded hover:bg-yellow-300 transition mr-2 text-sm">
                    <i class="fa-solid fa-pen mr-1"></i> Edit
                </a>
                <a href="{% url 'transaction-delete' transaction.pk %}" class="inline-flex items-center bg-red-600 text-white px-3 py-1 rounded hover:bg-red-500 transition text-sm">
                    <i class="fa-solid fa-trash mr-1"></i> Delete
                </a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="7" class="text-center text-gray-400 py-6 italic">No transactions yet.</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}